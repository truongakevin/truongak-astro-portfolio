---
import Layout from '../layouts/Layout.astro';
// contact.astro
---

<Layout title="home - kevinatruong">
	<main>
		<h2 id="title">CONTACT ME</h2>
		<form id="contactForm" action="https://kevinatruong.com/api/node-contact" method="POST">
			<label for="name">NAME</label><br>
			<input type="text" id="name" name="name" required/><br>
			
			<label for="email">EMAIL</label><br>
			<input type="text" id="email" name="email" required/><br>
			
			<label for="message">MESSAGE</label><br>
			<textarea id="message" name="message" required></textarea><br>
			
			<button type="submit" id="submitButton">
				SEND
			</button>
			</div>
		</form>
		<script>
			document.getElementById('contactForm').addEventListener('submit', async function (e) {
			e.preventDefault();

			const formData = {
				name: (document.getElementById('name') as HTMLInputElement).value,
				email: (document.getElementById('email') as HTMLInputElement).value,
				message: (document.getElementById('message') as HTMLTextAreaElement).value,
			};
			
			const submitButton = document.getElementById('submitButton') as HTMLButtonElement;
			submitButton.innerHTML = "<img id='loading' style='width: 15px;' src='https://global.discourse-cdn.com/sitepoint/original/3X/e/3/e352b26bbfa8b233050087d6cb32667da3ff809c.gif'/>"
			submitButton.disabled = true

			try {
				// const response = await fetch('http://localhost:3000/api/contact', {
				const response = await fetch('https://kevinatruong.com/api/contact', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json',
					},
					body: JSON.stringify(formData),
				});
				const result = await response.text();
				// alert(result);
			} catch (error) {
				console.error('Error:', error);
			} finally {
				const title = document.getElementById('title') as HTMLInputElement;
				const input = document.getElementById('contactForm') as HTMLInputElement;
				title.innerHTML = "THANK YOU FOR YOUR MESSAGE."
				input.innerHTML = ""
			}
			});
		</script>
	</main>
</Layout>

<style>
	@media screen and (min-width: 768px){
		main{
			padding-top: 120px;
		}
	}
	main {
		font-size: .60em;
	}
	h2 {
		margin: 20px 0;
	}
	input, textarea, button {
		background-color: var(--primary);
		color: var(--secondary);
		width: 60%;
		height: 1.75em;
		padding-left: .2em;
		margin-top: 5px;
		margin-bottom: 20px;
		border: 5px solid var(--primary);
		font-size: .75em;
	}
	textarea {
		padding: 10px;
		height: 300px;
		width: 90%;
	}
	input:focus, textarea:focus {
		outline: none;
	}
	button {
		width: 5em;
		margin-bottom: 100;
	}

	button img {}
</style>