---
import Layout from '../layouts/Layout.astro';
import CurrentlyPlaying from '../components/CurrentlyPlaying';

const response = await fetch('https://kevinatruong.com/api/spotify/data');
const spotifyData = await response.json();
---

<Layout title="music - kevinatruong">
	<main>
		<div class="profile">
			<div class="profile-pic">
				<img src={spotifyData.user_profile.profile_image} alt="Profile Image" />
			</div>
			<div class="profile-info">
				<a href="https://open.spotify.com/user/kevinolis" target="_blank" rel="noopener noreferrer">
					{spotifyData.user_profile.display_name}
				</a>
				<div class="currently-playing">
					<!-- <h3>currently playing</h3> -->
					<h3>CURRENTLY PLAYING</h3>
					<CurrentlyPlaying client:load/>
				</div>
			</div>
		</div>

		<!-- <h2>top artists this month</h2> -->
		<h2>TOP ARTISTS THIS MONTH</h2>
		<div class="artists-container">
			<div class="artists">
				{spotifyData.top_artists.map((artist) => (
					<div class="artist">
						<img src={artist.images} alt={artist.name} />
						<h4>{artist.name}</h4>
					</div>
				))}
			</div>
		</div>
		
		<!-- <h2>top tracks this month</h2> -->
		<h2>TOP TRACKS THIS MONTH</h2>
		<div class="tracks">
			{spotifyData.top_tracks.map((track) => (
				<div class="track">
					<div class="track-pic">
						<img src={track.album_image} alt={track.album} />
					</div>
					<div class="track-info">
						<h3>{track.name}</h3>
						<h4>{track.artists}</h4>
					</div>
				</div>
			))}
		</div>

		<!-- <h2>my playlists</h2> -->
		<h2>PLAYLISTS</h2>
		<div class="playlists-container">
			<div class="playlists">
				{spotifyData.user_playlists.map((playlist) => (
					<div class="playlist">
						<img src={playlist.images} alt={playlist.name} />
						<h3>{playlist.name}</h3>
					</div>
				))}
			</div>
		</div>

		<br></br>
		<br></br>
	</main>
</Layout>
<style>
	main {
		margin-left: 0;
		margin-right: 0;
		font-size: .4em;
	}
	h2 {
		margin: 40px 20px 20px;
	}
	img {
		object-fit: cover;
	}
	/* profile div ============================ */
	.profile {
		display: flex;
		margin: 20px;
	}
	.profile-pic img {
		width: 200px;
		height: 200px;
	}
	.profile-info {
		margin: 10px;
		margin-right: 0;
	}
	.profile-info a {
		text-decoration: none;
		margin: 0;
		color: var(--primary);
		font-size: 2.5em;
	}
	.profile-info a h1 {
	}
	.profile-info > * {
		margin: 5px 0;
	}
	.currently-playing h3 {
		margin: 5px 0;
		margin-top: 10px;
	}

	/* artists div ============================ */
	.artists-container {
		overflow-x: auto;
		max-width: 100%;
	}
	.artists-container::-webkit-scrollbar {
		display: none;
	}
	.artists {
		display: flex;
		flex-direction: row;
	}
	.artist {
		flex: 0 0 200px;
		margin-left: 20px;
	}
	.artist img {
		width: 100%;
		height: 200px;
		border-radius: 100px;
	}
	.artist > * {
		margin: 2px;
	}
	
	/* tracks div ============================ */
	.tracks {
		margin: 20px;
	}
	.track {
		display: flex;
		flex-direction: row;
		margin: 5px;
	}
	.track-pic img {
		width: 75px;
		height: 75px;
	}
	.track-info {
		margin: auto 10px;
	}
	.track-info > * {
		margin: 0;
	}

	/* playlists div ============================ */
	.playlists-container {
		overflow-x: auto;
		max-width: 100%;
	}
	.playlists-container::-webkit-scrollbar {
		display: none;
	}
	.playlists {
		display: flex;
		flex-direction: row;
	}
	.playlist {
		flex: 0 0 250px;
		margin-left: 20px;
	}
	.playlist img {
		width: 100%;
		height: 250px;
	}
	.playlist > * {
		margin: 0;
	}
	@media screen and (max-width: 768px) {
		main {
			margin: 0;
		}
		h2 {
			margin: 25px 10px 10px;
		}
		.profile {
			margin: 10px;
		}
		.profile-pic img {
			width: 150px;
			height: 175px;
		}
		.artist {
			margin-left: 10px;
		}
		.tracks {
			margin: 10px;
		}
		.playlist {
			margin-left: 10px;
		}
	}
</style>
